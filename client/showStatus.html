<template name='showStatus'>
{{#if currentUser}}
{{#with currentActiveShow}}
<h2><a href="{{pathFor 'editShow' showId=_id}}">{{showName}}</a> is live!</h2>
<h3>@ {{showStart}} by {{#each user.emails}}{{address}}{{/each}}</h3>
<h4>{{defaultMeta}}</h4>

<!-- Add song track to this show here-->
<hr>
<div class="row">
		<section class="content">
				<div class="col-md-8 col-md-offset-2">
				<div class="panel panel-default">

					<div class="panel-body">
						<div class="table-container">
							<table class="table table-filter">
								<tbody>
								<h3>Active show tracks</h3>
							{{#each showTracks}}
									<tr class="track {{#unless $eq trackType 'song'}}special-track{{/unless}}">
                    <td>
                      {{#if $neq indexNumber 0}}
                        <a href="javascript:;" data-move-up="{{_id}}">
                            <i class="glyphicon glyphicon-chevron-up"></i>
                        </a>
                      {{/if}}
                      {{#if $neq indexNumber ../getHighestTrackNumber}}
                          <a href="javascript:;" data-move-down="{{_id}}">
                              <i class="glyphicon glyphicon-chevron-down"></i>
                          </a>
                      {{/if}}
                    </td>
										<td>
                      {{#if isHighlighted}}
											<a href="javascript:;" class="star">
												<i class="glyphicon glyphicon-star"></i>
											</a>
                      {{/if}}
										</td>
										<td>
											<div class="media">
												<div class="media-body">
													<!-- {{#unless isQueuedForNext}}
														<button class="btn btn-info" data-queue-song-id="{{_id}}">Queue Song</button>
													{{/unless}} -->
													{{#if playDate}}
													<span class="media-meta pull-right"><button class="btn btn-warning" data-restart-track-id="{{_id}}">Restart Track</button>
													{{playDate}}</span>
													{{else}}
														<button class='btn btn-success' data-start-track-id="{{_id}}">Start Track</button>
													{{/if}}
													<h4 class="title">
													 <a href="{{pathFor 'edittrack' trackId=_id}}">Title: {{songTitle}}</a>
													</h4>
													<h4 class="title">
  													<span class="pull-right"> Album: {{album}}</span>
  													Artist: {{artist}}
                            <h5>Length: <span class="media-meta"> {{trackLength}} </span></h5>
													</h4>
                          <h4 class="title">
                              Track order: {{indexNumber}}
                          </h4>
												</div>
											</div>
										</td>
									</tr>
									{{/each}}
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</section>
	</div>
<div class="show-control-panel">
  <div class="pull-right">
    {{#if hasNextTrack}}
    <div class="autoplay-label">AutoPlay</div>
    {{/if}}
  <button class="btn btn-danger" data-stop-show>Stop Show</button>
 {{#if isShowingDefaultMeta}}
 {{#unless trackIsShowMeta}}
 <button class="btn btn-warning" data-stop-default-tracking>Display song title</button>
 {{/unless}}
 {{else}}
 <button class="btn btn-primary" data-start-default-tracking>Display show title</button>
 {{/if}}
 {{#unless isShowingDescription}}
 <button class="btn btn-warning" data-show-description>Show Description</button>
 {{else}}
 <button class="btn btn-primary" data-hide-description>Hide Description</button>
 {{/unless}}
 <button class="btn btn-warning" data-clear-highlighted>Clear Starred Tracks</button>
 {{#afModal formId="insertTracklistModal" class="btn btn-primary" collection="Tracklists" operation="insert" omitFields="isHighlighted,showId,indexNumber,playDate"}}
  Add a new track
{{/afModal}}
</div>
<div class="pull-left">
  {{#if hasNextTrack}}
  {{#unless reloadAutoplay}}
{{#autoForm collection="Shows" type="update" id="autoplayToggle" doc=this autosave=true}}
 {{> afFieldInput name="isAutoPlaying"}}
 {{/autoForm}}
 {{else}}
 {{setAutoPlay}}
 {{/unless}}
 {{/if}}
</div>
</div>
{{/with}}
{{/if}}
</template>
